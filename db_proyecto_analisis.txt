CREATE DATABASE IF NOT EXISTS DB_CONTABILIDAD;
USE DB_CONTABILIDAD;

-- Tabla: ASIENTOS
CREATE TABLE ASIENTOS (
    ASIENTO_ID INT AUTO_INCREMENT PRIMARY KEY,
    FECHA DATETIME NOT NULL,
    DESCRIPCION VARCHAR(500) NOT NULL,
    id_periodo INT
);

-- Tabla: BalanceGeneral
CREATE TABLE BalanceGeneral (
    CUENTA_ID INT PRIMARY KEY,
    Codigo VARCHAR(50) NOT NULL,
    Nombre VARCHAR(255) NOT NULL,
    TOTAL_DEBE DECIMAL(18,2),
    TOTAL_HABER DECIMAL(18,2),
    Saldo DECIMAL(18,2)
);

-- Tabla: BalanceSaldos
CREATE TABLE BalanceSaldos (
    CUENTA_ID INT PRIMARY KEY,
    Codigo VARCHAR(50) NOT NULL,
    Nombre VARCHAR(255) NOT NULL,
    TOTAL_DEBE DECIMAL(18,2),
    TOTAL_HABER DECIMAL(18,2),
    Saldo DECIMAL(18,2)
);

-- Tabla: CUENTAS
CREATE TABLE CUENTAS (
    CUENTA_ID INT AUTO_INCREMENT PRIMARY KEY,
    CODIGO VARCHAR(50) NOT NULL,
    NOMBRE VARCHAR(255) NOT NULL,
    TIPO VARCHAR(50) NOT NULL
);

-- Tabla: DETALLE_ASIENTO
CREATE TABLE DETALLE_ASIENTO (
    DETALLE_ID INT AUTO_INCREMENT PRIMARY KEY,
    ASIENTO_ID INT NOT NULL,
    CUENTA_ID INT NOT NULL,
    DEBE DECIMAL(18,2),
    HABER DECIMAL(18,2),
    FOREIGN KEY (ASIENTO_ID) REFERENCES ASIENTOS(ASIENTO_ID),
    FOREIGN KEY (CUENTA_ID) REFERENCES CUENTAS(CUENTA_ID)
);

-- Tabla: EstadoResultados
CREATE TABLE EstadoResultados (
    CUENTA_ID INT PRIMARY KEY,
    Codigo VARCHAR(50) NOT NULL,
    Nombre VARCHAR(255) NOT NULL,
    TOTAL_DEBE DECIMAL(18,2),
    TOTAL_HABER DECIMAL(18,2),
    Resultado DECIMAL(18,2)
);

-- Tabla: EstadosFinancieros
CREATE TABLE EstadosFinancieros (
    TIPO_ESTADO VARCHAR(50) NOT NULL,
    CUENTA_ID INT NOT NULL,
    Codigo VARCHAR(50) NOT NULL,
    Nombre VARCHAR(255) NOT NULL,
    TOTAL_DEBE DECIMAL(18,2),
    TOTAL_HABER DECIMAL(18,2),
    Saldo DECIMAL(18,2),
    PRIMARY KEY (TIPO_ESTADO, CUENTA_ID)
);

-- Tabla: JERARQUIA
CREATE TABLE JERARQUIA (
    ID_JERARQUIA INT AUTO_INCREMENT PRIMARY KEY,
    CODIGO_CUENTA_PADRE INT NOT NULL,
    CODIGO_CUENTA_HIJA VARCHAR(50),
    NIVEL INT
);

-- Tabla: LIBRO_DIARIO
CREATE TABLE LIBRO_DIARIO (
    ID INT AUTO_INCREMENT PRIMARY KEY,
    FECHA DATETIME NOT NULL,
    CODIGO_CUENTA VARCHAR(50) NOT NULL,
    NOMBRE_CUENTA VARCHAR(255) NOT NULL,
    DEBE DECIMAL(18,2),
    HABER DECIMAL(18,2),
    DESCRIPCION VARCHAR(500)
);

-- Tabla: LIBRO_MAYOR
CREATE TABLE LIBRO_MAYOR (
    CUENTA_ID INT AUTO_INCREMENT PRIMARY KEY,
    CODIGO VARCHAR(50) NOT NULL,
    NOMBRE VARCHAR(255) NOT NULL,
    FECHA DATETIME NOT NULL,
    DEBE DECIMAL(18,2),
    HABER DECIMAL(18,2),
    SALDO DECIMAL(18,2)
);

-- Tabla: PERIODOS
CREATE TABLE PERIODO (
    ID_PERIODO INT AUTO_INCREMENT PRIMARY KEY,
    DESCRIPCION VARCHAR(255),
    ESTADO BOOL,
    FECHA_INICIO DATE NOT NULL,
    FECHA_FIN DATE NOT NULL,
    ID_PERIODO_ANTERIOR INT,
    FOREIGN KEY (ID_PERIODO_ANTERIOR) REFERENCES PERIODO(ID_PERIODO)
);

CREATE TABLE SALDOCUENTAPERIODO (
    ID_SALDO INT AUTO_INCREMENT PRIMARY KEY,
    CUENTA_ID INT NOT NULL,
    ID_PERIODO INT NOT NULL,
    SALDO_INICIAL DECIMAL(18,2),
    TOTAL_DEBE DECIMAL(18,2),
    TOTAL_HABER DECIMAL(18,2),
    SALDO_FINAL DECIMAL(18,2),
    FOREIGN KEY (CUENTA_ID) REFERENCES CUENTAS(CUENTA_ID),
    FOREIGN KEY (ID_PERIODO) REFERENCES PERIODO(ID_PERIODO)
);